this.CanAutoplay=!1,function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("SS requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";function i(t,i){var r=!0,a="",n=!e.requestAnimationFrame,s={done:function(){},fail:function(){}},o="POST",c=new XMLHttpRequest;if(i){if(i.async===!1&&(r=!1),i.cache===!1&&(o="GET",t=t+"?_="+(new Date).getTime()),i.data){var u=[];for(var l in i.data)i.data.hasOwnProperty(l)&&u.push(encodeURIComponent(l)+"="+encodeURIComponent(i.data[l]));a=u.join("&")}i.done&&(s.done=i.done),i.fail&&(s.fail=i.fail)}"POST"===o&&n&&(c=new e.XDomainRequest,c.onload=function(){s.done.call(s,c)},c.onerror=function(){s.fail.call(s,c)},c.onprogress=function(){},c.ontimeout=function(){}),c.open(o,t,r),c.setRequestHeader&&(c.setRequestHeader("content-type","application/x-www-form-urlencoded"),c.onreadystatechange=function(){4===this.readyState&&(200===this.status?s.done.call(s,this):s.fail.call(s,this))}),setTimeout(function(){c.send(a)},0)}function r(){try{var t=new Audio;t.addEventListener("play",function(){e.CanAutoplay=!0},!1),t.volume=0,t.autoplay=!0,t.src="end-sound.mp3"}catch(e){}}function a(t){return t&&(e.location.hash="debug"),"#debug"===e.location.hash}function n(){if("~"!==Le)switch(Le="~",Pe){case Y:case Z:Re.Exit();break;case ie:He.Terminate();break;case ae:}}function s(e){for(var t=0;t<qe.length;t++)if(qe[t].getAttribute("file")===e)return t+1}function o(e){for(var t=0;t<qe.length;t++)if(qe[t].getAttribute("file")===e)return qe[t];return qe[0]}function c(t){"~"===Le&&u(Se,!a()),e.addEventListener("beforeunload",n),Q.onkeydown=function(e){var t=!1;33===e.which&&(Be||a())&&(d(),t=!0),34===e.which&&ze&&(g(),t=!0),a()||119===e.which&&(a(!0),t=!0,u("Debug enabled")),t&&e.preventDefault()},f(),t("resume"===Ee)}function u(t,i){i?alert(t):e.console&&e.console.log&&e.console.log(t)}function l(e,t){var i=new Date;i.setTime(e);var r="",a="000"+Math.floor(e/36e5),n="0"+i.getMinutes(),s="0"+i.getSeconds(),o="0"+Math.round(i.getMilliseconds()/10);if(r=a.substr(a.length-4)+":"+n.substr(n.length-2)+":",r+=s.substr(s.length-2)+"."+o.substr(o.length-2),t===re){var c=r.split(":"),u=c[0],l=c[1],d=c[2];r="PT"+u+"H"+l+"M"+d+"S"}return r}function d(){if(Pe===W&&Fe<s(C.getAttribute("file")))alert(we);else{for(var e,t=!1,i=Me?C.getElementsByTagName("kickback"):qe,r=Me?P.getAttribute("file"):C.getAttribute("file"),a=0;a<i.length;a++){var n=i[a].getAttribute("file");if(t){e=n;break}r===n&&(t=!0)}t&&e?_(o(e)):Me&&(Me=!1,P=void 0,_(C,!0))}}function f(){var e,t=z.getElementsByTagName("topics");Ce.scoId||(Ce.scoId=z.getElementsByTagName("languages")[0].getAttribute("default"));for(var i=0;i<t.length;i++){var r=t[i];r.getAttribute("lang")===Ce.scoId&&(e=r,Q.title=e.getAttribute("title"))}qe=[];var a=e.getElementsByTagName("page"),n=["survey"];Pe===te&&n.push("quiz"),Ue=0;for(var s=0;s<a.length;s++){var o=a[s].getAttribute("pType");n.indexOf(o)===-1&&(qe.push(a[s]),"quiz"===o&&Ue++)}}function m(e){var t={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([\w\.\-\_]+)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},i={},r=e.substring(e.indexOf("[")).split(/\n|\r\n/g),a=null;return r.forEach(function(e){if(!t.comment.test(e))if(t.param.test(e)){var r=e.match(t.param);a?i[a.toLowerCase()][r[1].toLowerCase()]=r[2]:i[r[1].toLowerCase()]=r[2]}else if(t.section.test(e)){var n=e.match(t.section);i[n[1].toLowerCase()]={},a=n[1].toLowerCase()}else 0===e.length&&a&&(a=null)}),i}function g(){var e,t=Me?C.getElementsByTagName("kickback"):qe,i=Me?P.getAttribute("file"):C.getAttribute("file");if(t[0].getAttribute("file")!==i){for(var r=0;r<t.length;r++){var a=t[r].getAttribute("file");if(e&&i===a)break;e=a}_(o(e))}}function p(e){try{return JSON.parse(e)}catch(e){return{}}}function h(e){e?(F.setAttribute("hidden","hidden"),U.removeAttribute("hidden")):(U.setAttribute("hidden","hidden"),F.removeAttribute("hidden"))}function _(e,t){if("~"!==Le){var i=new Date,r=i.getTime()-ke.getTime(),a=l(r,Pe);Me||(Ne=e.getAttribute("file")),Ve=a.toString(),"true"===e.getAttribute("end")&&(xe="",B?Te=ce:(Te=ne,M&&(Te=ce,Ge="100.00")))}switch(Pe){case Y:case Z:Re.Put(e,t);break;case ie:Me||He.SetValue(me,Ne),He.GetLastError()===le&&(He.SetValue(ge,Ve),He.SetValue(fe,xe),He.SetValue(he,Te),He.SetValue(pe,Ge),He.SetValue(ve,JSON.stringify(Ce))),He.GetLastError()===le&&He.Commit(),b(e,He.GetLastError(),t);break;case ae:default:b(e,ue,t)}return!1}function b(t,i,r){if(i===le||a()){var o=t.getAttribute("file"),c=s(o),l="true"===t.getAttribute("end"),d="quiz"===t.getAttribute("pType")||"summary"===t.getAttribute("pType");if(q&&q.html(c+" / "+qe.length),X){var f=c/qe.length;isNaN(f)&&(f=0),f>1&&(f=1),X(100*f)}if(r)h(!0),F.src="",setTimeout(function(){U.focus()},1e3),Be=!1,ze=!0;else{var m;Me?(h(!1),m=F,ze=C.getElementsByTagName("kickback")[0].getAttribute("file")!==o):(h(!0),m=U,ze=qe[0].getAttribute("file")!==o),m.src=o,setTimeout(function(){m.focus()},1e3),Be=!(!Me&&(d||De&&c>1))}ze?J():j(),Be?H():R(),(d||l)&&je.SlideStart({}),l&&($(),e.setTimeout(n,1e3)),Me?P=t:C=t}else u(ye,!a())}function v(e){var t=Q.createElement("audio");t.id="end",t.src="end-sound.mp3",t.preload="auto",t.volume=0,Q.body.appendChild(t),r(),K.mode&&(a(!0),K.mode===te&&(Pe=te),K.mode===W&&(Pe=W,K.limit&&(Fe=K.limit))),Pe===ee&&"true"===He.Initialize(re)&&(Pe=re),Pe===ee&&"true"===He.Initialize(ie)&&(Pe=ie),Pe===ee&&K.aicc_url&&K["sub-relay"]&&(Pe=Y,Re._relayUrl=K["sub-relay"]+"?relay-url="+K.aicc_url),Pe===ee&&K.aicc_url&&(Pe=Z,Re._relayUrl=K.aicc_url);var n=Q.querySelector("meta[name=author]"),s=Math.floor(ke.getTime()/864e5-ke.getTimezoneOffset()/1440+2440587.5);if(n&&n.getAttribute("content")<s)u(Ae,!a());else{var o="sco.xml";K.sco&&(o=K.sco),i(o,{cache:!1,done:function(t){z=t.responseXML;var i=z.getElementsByTagName("sco")[0];switch(i.getAttribute("mastery-score")&&(B=i.getAttribute("mastery-score")),u("SS v"+je.version+" Initialized, Tracking type: "+Pe),Pe){case Y:case Z:Re.Init(e);break;case ie:if("not attempted"===He.GetValue(he)&&He.SetValue(he,oe),Le=He.GetValue(_e),Ie=He.GetValue(be),Ee=He.GetValue(de),Ne=He.GetValue(me),Ge=He.GetValue(pe),""!==He.GetValue(ve)){var r=He.GetValue(ve);0===r.lastIndexOf("suspend_data=",0)&&(r=r.slice(13)),Ce=p(r)}c(e);break;case ae:default:c(e)}}})}}function y(){for(var e=z.getElementsByTagName("language"),t=[],i=0;i<e.length;i++){var r=e[i];t[i]={id:r.getAttribute("id"),label:r.getAttribute("label")}}return t}function w(e){Q.getElementById("end").play(),e&&(Ce.scoId=e),Ne="",f()}function S(){Q.getElementById("end").play()}function A(){for(var e=z.getElementsByTagName("language"),t={},i=0;i<e.length;i++){var r=e[i];if(r.getAttribute("id")===Ce.scoId)for(var a=r.childNodes,n=0;n<a.length;n++)a[n].textContent?t[a[n].tagName]=a[n].textContent:t[a[n].tagName]=a[n].firstChild.nodeValue}return t}function k(e){e.presentorFrame.html('<iframe id="slide-kick" title="Kickback slide" allowfullscreen></iframe><iframe id="slide-frame" title="Main slide" allowfullscreen></iframe>'),D=e.onAnimate,X=e.setProgressBar,$=e.onScoFinish,q=e.frameField,U=Q.getElementById("slide-frame"),F=Q.getElementById("slide-kick"),e.titleField&&e.titleField.html(Q.title),e.commaHack&&(O=!0),e.scoreHack&&(M=!0),_(o(Ne))}function T(e){return R=e.onDisable,H=e.onEnable,e.disableOnNext&&Pe!==te&&(De=e.disableOnNext),d}function E(e){return j=e.onDisable,J=e.onEnable,g}function x(){return Ie}function L(){e.CanAutoplay||r(),setTimeout(function(){var t=Q.getElementById("end");t.volume=1,t.play(),e.CanAutoplay?(H(),Be=!0):d()},1e3)}function I(e){D&&D()}function N(){var e=0;Ce.answered&&(e=Ce.answered.length);var t=e/Ue;return{answered:e,passed:t>=B,percent:(100*t).toFixed(2),total:Ue}}function G(){if(B&&"quiz"===C.getAttribute("pType")){var e=-1;if(Ce.answered?e=Ce.answered.indexOf(C.getAttribute("file")):Ce.answered=[],e===-1){Ce.answered.push(C.getAttribute("file"));var t=0;Ce.answered&&(t=Ce.answered.length);var i=t/Ue;Ge=(100*i).toFixed(2)}}d()}function V(){var e=C.getElementsByTagName("kickback")[0];if(B){var t=-1;if(Ce.answered&&(t=Ce.answered.indexOf(C.getAttribute("file"))),t>-1){Ce.answered.splice(t,1);var i=0;Ce.answered&&(i=Ce.answered.length);var r=i/Ue;Ge=(100*r).toFixed(2)}e?(Me=!1,_(o(e.getAttribute("file")))):d()}else e&&(Me=!0,_(o(e.getAttribute("file"))))}var C,P,O,M,B,z,q,F,U,D,R,H,j,J,X,$,Q=e.document,K=e.querystrings||{},Y="aicc",W="demo",Z="aicc-local",ee="none",te="playthrough",ie="1.2",re="2004",ae="xapi",ne="completed",se="failed",oe="incomplete",ce="passed",ue="100",le="0",de="cmi.core.entry",fe="cmi.core.exit",me="cmi.core.lesson_location",ge="cmi.core.session_time",pe="cmi.core.score.raw",he="cmi.core.lesson_status",_e="cmi.core.student_id",be="cmi.core.student_name",ve="cmi.suspend_data",ye="An error occurred with the action you performed, if you continue to get this message please close and restart the course. \n\n Se ha producido un error en la accion realizada, si usted continua recibir este mensaje, por favor, cierre y reinicie el curso.",we="Thank you for watching this course demo!",Se="This course encountered an error. Your progress will NOT be recorded. Please close and restart the course. \n\n Este curso ha detectado un error. NO se grabara su progreso. Por favor, cierre y reincie el curso.",Ae="Sorry this subscription is no longer active. Please contact your supervisor or SafetySkills support at support@safetyskills.com",ke=new Date,Te=oe,Ee="",xe="suspend",Le="~",Ie="Example, Anne E.",Ne="",Ge="",Ve="00:00:00",Ce={},Pe=ee,Oe=!1,Me=!1,Be=!1,ze=!1,qe=[],Fe=4,Ue=0,De=!1,Re={_relayUrl:"",_version:"4.0",Exit:function(){i(this._relayUrl,{async:!1,data:{command:"ExitAU",version:this._version,session_id:K.aicc_sid}})},Init:function(e){i(this._relayUrl,{data:{command:"GetParam",version:this._version,session_id:K.aicc_sid},done:function(t){u(t.responseText);var i=m(t.responseText),r=i.core.lesson_status.toLowerCase(),a=r.trim().slice(0,1);if(Le=i.core.student_id,Ie=i.core.student_name,Ne=i.core.lesson_location,"n;i".split(";").indexOf(a)>-1?Te=oe:(Te="f"===a?se:"p"===a?ce:ne,Oe=!0),r.indexOf(",")>-1){var n=r.split(",")[1].trim().slice(0,1);"a"===n&&(Ee="ab-initio"),("r"===n||Ne&&""!==Ne)&&(Ee="resume")}var s=i.core.score.split(",");Ge=s[0],i.core_lesson&&i.core_lesson.suspend_data&&(Ce=p(i.core_lesson.suspend_data)),c(e)},fail:function(t){402===t.status&&u(Ae,!a()),c(e)}})},Put:function(e,t){var r=Te,n="";Oe||r!==ne&&r!==ce||(Oe=!0,n=this._relayUrl.indexOf("?")>-1?"&completed=true":"?completed=true"),(""!==xe||O)&&(r=r+","+xe);var s=["[core]","lesson_location="+Ne,"score="+Ge,"lesson_status="+r,"time="+Ve,"[core_lesson]","suspend_data="+JSON.stringify(Ce)].join("\r\n");i(this._relayUrl+n,{data:{command:"PutParam",version:this._version,session_id:K.aicc_sid,aicc_data:s},done:function(i){b(e,le,t),u(i.responseText)},fail:function(i){402===i.status?u(Ae,!a()):b(e,ue,t)}})}},He={_api:void 0,_getApi:function(t){this._api=this._scanParents(e),this._api||e.parent===e||(this._api=this._scanParents(e.parent,t)),!this._api&&e.opener&&(this._api=this._scanParents(e.opener,t))},_scanParents:function(e,t){try{for(var i=0;!e[t]&&e.parent!==e;){if(i++,i>10)return;e=e.parent}return e[t]}catch(e){return}},Commit:function(){var e="false";return this._api&&(e=Pe===re?this._api.Commit(""):this._api.LMSCommit("")),e.toString()},GetLastError:function(){var e=100;return this._api&&(e=Pe===re?this._api.GetLastError():this._api.LMSGetLastError()),e.toString()},GetValue:function(e){var t="",i=ue;if(this._api){if(Pe===re){switch(e){case he:e="cmi.completion_status";break;case de:e="cmi.entry";break;case ge:e="cmi.session_time";break;case"cmi.core.total_time":e="cmi.total_time";break;case me:e="cmi.location";break;case be:e="cmi.learner_name";break;case _e:e="cmi.learner_id";break;case"cmi.student_preference._children":e="cmi.learner_preference._children";break;case"cmi.student_preference.language":e="cmi.learner_preference.language";break;case"cmi.core.score._children":e="cmi.score._children";break;case pe:e="cmi.score.raw";break;case"cmi.core.score.min":e="cmi.score.min";break;case"cmi.core.score.max":e="cmi.score.max"}t=this._api.GetValue(e),i=this._api.GetLastError().toString()}else t=this._api.LMSGetValue(e),i=this._api.LMSGetLastError().toString();i!==le&&(t="")}return t.toString()},Initialize:function(e){var t="false";return e===re?(this._getApi("API_1484_11"),this._api&&(t=this._api.Initialize(""))):(this._getApi("API"),this._api&&(t=this._api.LMSInitialize(""))),t.toString()},SetValue:function(e,t){if(this._api)if(Pe===re){switch(e){case he:t!==ce&&t!==se||(e="cmi.success_status"),t!==ne&&t!==oe||(e="cmi.completion_status");break;case ge:e="cmi.session_time";break;case me:e="cmi.location";break;case fe:e="cmi.exit";break;case pe:e="cmi.score.raw",this._api.SetValue("cmi.score.scaled",t/100)}this._api.SetValue(e,t)}else this._api.LMSSetValue(e,t)},Terminate:function(){var e="false";return this._api&&(e=Pe===re?this._api.Terminate(""):this._api.LMSFinish("")),e.toString()}},je={InitSco:v,GetLanguages:y,SelectLanguage:w,Resume:S,GetLocalizedValues:A,InitInterface:k,CC:function(){},Mute:function(){},Next:T,Play:function(){},Previous:E,Replay:function(){},GetStudentName:x,SlideEnd:L,SlideStart:I,ScoreResults:N,QuizCorrect:G,QuizIncorrect:V,version:"3.0.6"};return"function"==typeof define&&define.amd&&define("ss",[],function(){return je}),t||(e.SS=e.NS=je),je});
//# sourceMappingURL=ss.3.0.min.js.map
