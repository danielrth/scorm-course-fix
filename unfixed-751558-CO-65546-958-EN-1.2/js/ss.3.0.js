!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("SS requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(t,i){var n=!0,a="",r=!e.requestAnimationFrame,s={done:function(){},fail:function(){}},o="POST",c=new XMLHttpRequest;if(i){if(i.async===!1&&(n=!1),i.cache===!1&&(o="GET",t=t+"?_="+(new Date).getTime()),i.data){var u=[];for(var l in i.data)i.data.hasOwnProperty(l)&&u.push(encodeURIComponent(l)+"="+encodeURIComponent(i.data[l]));a=u.join("&")}i.done&&(s.done=i.done),i.fail&&(s.fail=i.fail)}"POST"===o&&r&&(c=new e.XDomainRequest,c.onload=function(){s.done.call(s,c)},c.onerror=function(){s.fail.call(s,c)},c.onprogress=function(){},c.ontimeout=function(){}),c.open(o,t,n),c.setRequestHeader&&(c.setRequestHeader("content-type","application/x-www-form-urlencoded; charset=utf-8"),c.onreadystatechange=function(){4===this.readyState&&(200===this.status?s.done.call(s,this):s.fail.call(s,this))}),setTimeout(function(){c.send(a)},0)}function n(){try{var e=new Audio;e.addEventListener("play",function(){ft.HasAutoPlay=!0},!1),e.volume=0,e.autoplay=!0,e.src="end-sound.mp3"}catch(t){}}function a(){if("~"!==Fe)switch(Fe="~",Qe){case ge:case he:lt.Exit();break;case be:dt.Terminate();break;case ve:}}function r(e){for(var t=0;t<st.length;t++)if(st[t].getAttribute("file")===e)return t+1}function s(e){for(var t=0;t<st.length;t++)if(st[t].getAttribute("file")===e)return st[t];return st[0]}function o(t){if("~"===Fe&&c(!0,Be),e.addEventListener("beforeunload",a),fe.onkeydown=function(e){var t=!1;33===e.which&&(it||Ze)&&(l(),t=!0),34===e.which&&at&&(m(),t=!0),106===e.which&&(ft.PlayToggle(),t=!0),36===e.which&&(g(),t=!0),Ze||119===e.which&&(Ze=!0,t=!0,c(!1,"Debug enabled")),t&&e.preventDefault()},Xe&&""!==Xe)for(var i=Xe.split("/")[0],n=ft.GetLanguages(),r=0;r<n.length;r++)n[r].id===i&&(Ke=i);d(Ke),t("resume"===qe)}function c(t,i){t?Ze?e.console.log(i):alert(i):e.console&&e.console.log&&e.console.log(i)}function u(e,t){var i=new Date;i.setTime(e);var n="",a="000"+Math.floor(e/36e5),r="0"+i.getMinutes(),s="0"+i.getSeconds(),o="0"+Math.round(i.getMilliseconds()/10);if(n=a.substr(a.length-4)+":"+r.substr(r.length-2)+":",n+=s.substr(s.length-2)+"."+o.substr(o.length-2),t===_e){var c=n.split(":"),u=c[0],l=c[1],d=c[2];n="PT"+u+"H"+l+"M"+d+"S"}return n}function l(){if(ot&&ot<r(U.getAttribute("file")))alert(Ie);else{for(var e,t=!1,i=et?U.getElementsByTagName("kickback"):st,n=et?q.getAttribute("file"):U.getAttribute("file"),a=0;a<i.length;a++){var o=i[a].getAttribute("file");if(t){e=o;break}n===o&&(t=!0)}t&&e?p(s(e)):et&&(et=!1,q=void 0,p(U,!0))}}function d(e){for(var t,i=F.getElementsByTagName("topics"),n=0;n<i.length;n++){var a=i[n];a.getAttribute("lang")===e&&(t=a,fe.title=t.getAttribute("title"))}st=t.getElementsByTagName("page"),ct=0;for(var r=0;r<st.length;r++){var s=st[r];"quiz"===s.getAttribute("pType")&&ct++}}function f(e){var t={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([\w\.\-\_]+)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},i={},n=e.substring(e.indexOf("[")).split(/\n|\r\n/g),a=null;return n.forEach(function(e){if(!t.comment.test(e))if(t.param.test(e)){var n=e.match(t.param);a?i[a.toLowerCase()][n[1].toLowerCase()]=n[2]:i[n[1].toLowerCase()]=n[2]}else if(t.section.test(e)){var r=e.match(t.section);i[r[1].toLowerCase()]={},a=r[1].toLowerCase()}else 0===e.length&&a&&(a=null)}),i}function m(){var e,t=et?U.getElementsByTagName("kickback"):st,i=et?q.getAttribute("file"):U.getAttribute("file");if(t[0].getAttribute("file")!==i){for(var n=0;n<t.length;n++){var a=t[n].getAttribute("file");if(e&&i===a)break;e=a}p(s(e))}}function g(){var e;e=et?K:Y,e.contentWindow.location.reload(!0),setTimeout(function(){e.focus()},1e3),ae&&(ae(),nt=!1)}function h(e){e?(K.setAttribute("hidden","hidden"),Y.removeAttribute("hidden")):(Y.setAttribute("hidden","hidden"),K.removeAttribute("hidden"))}function p(e,t){if("~"!==Fe){var i=new Date,n=i.getTime()-De.getTime(),a=u(n,Qe);et||(Xe=e.getAttribute("file")),Je=a.toString(),"true"===e.getAttribute("end")&&(Re="",Ue=R?Ae:ye)}switch(Qe){case ge:case he:lt.Put(e,t);break;case be:et||dt.SetValue(xe,Xe),dt.GetLastError()===ke&&(dt.SetValue(Ne,Je),dt.SetValue(Le,Re),dt.SetValue(Oe,Ue),dt.SetValue(Pe,je),dt.SetValue(Ve,$e)),dt.GetLastError()===ke&&dt.Commit(),b(e,dt.GetLastError(),t);break;case ve:b(e,Te,t);break;default:b(e,Te,t)}return!1}function b(t,i,n){if(i===ke||Ze){var s=t.getAttribute("file"),o=r(s),u="true"===t.getAttribute("end"),l="quiz"===t.getAttribute("pType")||"summary"===t.getAttribute("pType"),d=t.getElementsByTagName("bullets")[0];if(W&&W.html(o+" / "+st.length),oe){var f=o/st.length;isNaN(f)&&(f=0),f>1&&(f=1),oe(100*f)}if(We=d&&null!==d?e.XDomainRequest?d.xml:(new XMLSerializer).serializeToString(d):"",n)h(!0),K.src="",setTimeout(function(){Y.focus()},1e3),it=!1,at=!0;else{var m;et?(h(!1),m=K,at=U.getElementsByTagName("kickback")[0].getAttribute("file")!==s):(h(!0),m=Y,at=st[0].getAttribute("file")!==s),m.src=s,setTimeout(function(){m.focus()},1e3),it=!et&&(l||ut&&o>1)?!1:!0}at?se():re(),it?ie():te(),(l||u)&&ft.SlideStart({}),ae&&(ae(),nt=!1),u&&(ce(),e.setTimeout(a,1e3)),et?q=t:U=t}else c(!0,Me)}function _(e){var t=fe.createElement("audio");t.id="end",t.src="end-sound.mp3",t.preload="auto",t.volume=0,fe.body.appendChild(t),n(),me.debug&&(Ze=!0,c(!1,"Debug Enabled")),me.demo&&(Qe="Demo",Ze=!0,ot=me.demo),Qe===pe&&me.aicc_url&&me.subid&&(Qe=ge,lt._relayUrl+=me.subid+"?relay-url="+me.aicc_url),Qe===pe&&me.aicc_url&&me.local&&(Qe=he,lt._relayUrl=me.aicc_url),Qe===pe&&"true"===dt.Initialize(be)&&(Qe=be),c(!1,Qe+" selected");var a=fe.querySelector("meta[name=author]"),r=Math.floor(De.getTime()/864e5-De.getTimezoneOffset()/1440+2440587.5);if(a&&a.getAttribute("content")<r)c(!0,ze);else{var s="sco.xml";me.sco&&(s=me.sco),i(s,{cache:!1,done:function(t){F=t.responseXML,Ke=F.getElementsByTagName("languages")[0].getAttribute("default");var i=F.getElementsByTagName("sco")[0];switch(i.getAttribute("mastery-score")&&(R=i.getAttribute("mastery-score")),Qe){case ge:case he:lt.Init(e);break;case be:"not attempted"===dt.GetValue(Oe)&&dt.SetValue(Oe,we),Fe=dt.GetValue(Ge),He=dt.GetValue(Ce),qe=dt.GetValue(Ee),Xe=dt.GetValue(xe),je=dt.GetValue(Pe),""!==dt.GetValue(Ve)&&($e=JSON.parse(dt.GetValue(Ve))),o(e);break;case ve:break;default:o(e)}}})}}function v(){for(var e=F.getElementsByTagName("language"),t=[],i=0;i<e.length;i++){var n=e[i];t[i]={id:n.getAttribute("id"),label:n.getAttribute("label")}}return t}function y(e){fe.getElementById("end").play(),Ke=e?e:F.getElementsByTagName("languages")[0].getAttribute("default"),d(Ke),U=st[0]}function S(){if(fe.getElementById("end").play(),Xe&&""!==Xe)for(var e=Xe.split("/")[0],t=ft.GetLanguages(),i=0;i<t.length;i++)t[i].id===e&&(Ke=e);d(Ke);var n=s(Xe);n&&(U=n)}function w(){for(var e=F.getElementsByTagName("language"),t={},i=0;i<e.length;i++){var n=e[i];if(n.getAttribute("id")===Ke)for(var a=n.childNodes,r=0;r<a.length;r++)a[r].textContent?t[a[r].tagName]=a[r].textContent:t[a[r].tagName]=a[r].firstChild.nodeValue}return t}function A(e){e.presentorFrame.html('<iframe id="slide-kick" title="Kickback slide" allowfullscreen></iframe><iframe id="slide-frame" title="Main slide" allowfullscreen></iframe>'),Z=e.onAnimate,oe=e.setProgressBar,ce=e.onScoFinish,W=e.frameField,Y=fe.getElementById("slide-frame"),K=fe.getElementById("slide-kick"),e.titleField&&e.titleField.html(fe.title),p(U)}function T(){return rt?(le&&le(),rt=!1,$&&$()):(ue&&ue(),rt=!0,J&&J()),rt}function k(e){return ue=e.ccOff,le=e.ccOn,ue(),this.SubsToggle}function E(e){return ee=e.mute,de=e.unMute,de(),this.MuteToggle}function L(){return tt?(de&&de(),tt=!1,Q&&Q()):(ee&&ee(),tt=!0,H&&H()),tt}function x(e){return te=e.onDisable,ie=e.onEnable,e.disableOnNext&&(ut=e.disableOnNext),l}function N(e){return ne=e.pause,ae=e.play,this.PlayToggle}function P(){nt?(ae&&ae(),nt=!1,j&&j()):(ne&&ne(),nt=!0,X&&X())}function O(e){return re=e.onDisable,se=e.onEnable,m}function G(){return g}function C(){return He}function V(e){if(e){var t={Comments:e.Comments,CourseName:fe.title,Emphasis:e.Emphasis,Intro:e.Intro,Overall:e.Overall,ScreenHeight:screen.height,ScreenWidth:screen.width,Student:"",Summaries:e.Summaries,Thoroughness:e.Thoroughness,Url:location.href,UserAgent:navigator.userAgent};e.IsAnonymous?t.Student="anonymous":t.Student=He,i("https://admin.safetyskills.com/api/survey",{data:t,done:function(){c(!1,"Survey Data: "+t)}})}l()}function M(){ft.HasAutoPlay||n(),setTimeout(function(){var e=fe.getElementById("end");e.volume=1,e.play(),ft.HasAutoPlay?(ie(),it=!0):l()},1e3)}function I(e){H=e.slideMute,X=e.slidePause,j=e.slidePlay,J=e.subsOff,$=e.subsOn,Q=e.slideUnMute,tt&&H&&H(),rt&&J&&J(),Z&&Z(We)}function B(){var e=0;$e.answered&&(e=$e.answered.length);var t=e/ct;return{answered:e,passed:t>=R,percent:(100*t).toFixed(2),total:ct}}function z(){if(R&&"quiz"===U.getAttribute("pType")){var e=-1;if($e.answered?e=$e.answered.indexOf(U.getAttribute("file")):$e.answered=[],-1===e){$e.answered.push(U.getAttribute("file"));var t=0;$e.answered&&(t=$e.answered.length);var i=t/ct;je=(100*i).toFixed(2)}}l()}function D(){var e=U.getElementsByTagName("kickback")[0];if(R){var t=-1;if($e.answered&&(t=$e.answered.indexOf(U.getAttribute("file"))),t>-1){$e.answered.splice(t,1);var i=0;$e.answered&&(i=$e.answered.length);var n=i/ct;je=(100*n).toFixed(2)}e?(et=!1,p(s(e.getAttribute("file")))):l()}else e&&(et=!0,p(s(e.getAttribute("file"))))}var U,q,R,F,H,X,j,J,$,Q,W,K,Y,Z,ee,te,ie,ne,ae,re,se,oe,ce,ue,le,de,fe=e.document,me=e.querystrings||{},ge="aicc",he="aicc-local",pe="none",be="1.2",_e="2004",ve="xapi",ye="completed",Se="failed",we="incomplete",Ae="passed",Te="100",ke="0",Ee="cmi.core.entry",Le="cmi.core.exit",xe="cmi.core.lesson_location",Ne="cmi.core.session_time",Pe="cmi.core.score.raw",Oe="cmi.core.lesson_status",Ge="cmi.core.student_id",Ce="cmi.core.student_name",Ve="cmi.suspend_data",Me="An error occurred with the action you performed, if you continue to get this message please close and restart the course. \n\n Se ha producido un error en la accion realizada, si usted continua recibir este mensaje, por favor, cierre y reinicie el curso.",Ie="Thank you for watching this course demo!",Be="This course encountered an error. Your progress will NOT be recorded. Please close and restart the course. \n\n Este curso ha detectado un error. NO se grabara su progreso. Por favor, cierre y reincie el curso.",ze="Sorry this subscription is no longer active. Please contact your supervisor or SafetySkills support at support@safetyskills.com",De=new Date,Ue=we,qe="",Re="suspend",Fe="~",He="Example, Anne E.",Xe="",je="",Je="00:00:00",$e={},Qe=pe,We="",Ke="",Ye=!1,Ze=!1,et=!1,tt=!1,it=!1,nt=!1,at=!1,rt=!0,st=[],ot=0,ct=0,ut=!1,lt={_relayUrl:"https://scorm.safetyskills.com/relay/",_version:"4.0",Exit:function(){i(this._relayUrl,{async:!1,data:{command:"ExitAU",version:this._version,session_id:me.aicc_sid}})},Init:function(e){i(this._relayUrl,{data:{command:"GetParam",version:lt._version,session_id:me.aicc_sid},done:function(t){c(!1,t.responseText);var i=f(t.responseText),n=i.core.lesson_status.toLowerCase();if(Fe=i.core.student_id,He=i.core.student_name,Xe=i.core.lesson_location,"n;i".split(";").indexOf(n.slice(0,1))>-1?Ue=we:(Ue=n,Ye=!0),n.indexOf(",")>-1){var a=n.split(",")[1];"a"===a.slice(0,1)&&(qe="ab-initio"),("r"===a.slice(0,1)||!Xe&&""!==Xe)&&(qe="resume")}var r=i.core.score.split(",");je=r[0],i.core_lesson&&i.core_lesson.suspend_data&&($e=JSON.parse(i.core_lesson.suspend_data)),o(e)},fail:function(t){402===t.status&&c(!0,ze),o(e)}})},Put:function(e,t){var n=Ue,a="";Ye||(n===ye||n===Ae)&&(Ye=!0,a=this._relayUrl.indexOf("?")>-1?"&completed=true":"?completed=true"),""!==Re&&(n=n+","+Re),i(this._relayUrl+a,{data:{command:"PutParam",version:this._version,session_id:me.aicc_sid,aicc_data:"[CORE]\nlesson_location="+Xe+"\nscore="+je+"\nlesson_status="+n+"\ntime="+Je+"\n[CORE_LESSON]\r\nsuspend_data="+JSON.stringify($e)},done:function(i){b(e,ke,t),c(!1,i.responseText)},fail:function(i){402===i.status?c(!0,ze):b(e,Te,t)}})}},dt={_api:void 0,_getApi:function(e){var t="API";Qe===_e&&(t="API_1484_11"),this._api=this._scanParents(e),this._api||null==e.parent||e.parent==e||(this._api=this._scanParents(e.parent,t)),this._api||null==e.opener||(this._api=this._scanParents(e.opener,t))},_scanParents:function(e,t){for(var i=0;!e[t]&&null!=e.parent&&e.parent!=e;){if(i++,i>10)return;e=e.parent}return e[t]},Commit:function(){var e="false";return this._api&&(e=Qe===_e?this._api.Commit(""):this._api.LMSCommit("")),e.toString()},GetLastError:function(){var e=100;return this._api&&(e=Qe===_e?this._api.GetLastError():this._api.LMSGetLastError()),e.toString()},GetValue:function(e){var t="",i=Te;if(this._api){if(Qe===_e){switch(e){case Oe:e="cmi.completion_status";break;case Ee:e="cmi.entry";break;case Ne:e="cmi.session_time";break;case"cmi.core.total_time":e="cmi.total_time";break;case xe:e="cmi.location";break;case Ce:e="cmi.learner_name";break;case Ge:e="cmi.learner_id";break;case"cmi.student_preference._children":e="cmi.learner_preference._children";break;case"cmi.student_preference.language":e="cmi.learner_preference.language";break;case"cmi.core.score._children":e="cmi.score._children";break;case Pe:e="cmi.score.raw";break;case"cmi.core.score.min":e="cmi.score.min";break;case"cmi.core.score.max":e="cmi.score.max"}t=this._api.GetValue(e),i=this._api.GetLastError().toString()}else t=this._api.LMSGetValue(e),i=this._api.LMSGetLastError().toString();i!==ke&&(t="")}return t.toString()},Initialize:function(t){var i="false";return this._getApi(e),this._api&&(i=t===_e?this._api.Initialize(""):this._api.LMSInitialize("")),i.toString()},SetValue:function(e,t){if(this._api)if(Qe===_e){switch(e){case Oe:(t===Ae||t===Se)&&(e="cmi.success_status"),(t===ye||t===we)&&(e="cmi.completion_status");break;case Ne:e="cmi.session_time";break;case xe:e="cmi.location";break;case Le:e="cmi.exit";break;case Pe:e="cmi.score.raw",this._api.SetValue("cmi.score.scaled",t/100)}this._api.SetValue(e,t)}else e===Ve&&(t=JSON.stringify(t)),this._api.LMSSetValue(e,t)},Terminate:function(){var e="false";return this._api&&(e=Qe===_e?this._api.Terminate(""):this._api.LMSFinish("")),e.toString()}},ft={InitSco:_,GetLanguages:v,SelectLanguage:y,Resume:S,GetLocalizedValues:w,InitInterface:A,SubsToggle:T,CC:k,Mute:E,MuteToggle:L,Next:x,Play:N,PlayToggle:P,Previous:O,Replay:G,GetStudentName:C,SubmitSurvey:V,SlideEnd:M,SlideStart:I,ScoreResults:B,QuizCorrect:z,QuizIncorrect:D,HasAutoPlay:!1,version:"3.0"};return"function"==typeof define&&define.amd&&define("ss",[],function(){return ft}),void 0===t&&(e.SS=e.NS=ft),c(!1,"SS v"+ft.version+" Loaded"),ft});
//# sourceMappingURL=ss.3.0.js.map
