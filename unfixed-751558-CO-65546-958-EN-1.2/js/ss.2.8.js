this.CanAutoplay=!1,this.NS=function(e,t,a,n){"use strict";var i={},r={completion_status:"incomplete",credit:"credit",entry:"",exit:"suspend",launch_data:"",learner_id:"~",learner_name:"Example, Anne E.",location:"",mode:"normal",score:{raw:""},session_time:"00:00:00",success_status:"unknown",suspend_data:{}},s="none",o="100",c={bullets:"",captions:n,frame:n,kickback:n,language:"",nextEnabled:!1,previousEnabled:!0},l=!1,u=0,d={CommunicationIssue:" : An error occurred with the action you performed, if you continue to get this message please close and restart the course. \n\n Se ha producido un error en la accion realizada, si usted continua recibir este mensaje, por favor, cierre y reinicie el curso.",DemoExceeded:"Thank you for watching this course demo!",NotInitialized:"This course encountered an error. Your progress will NOT be recorded. Please close and restart the course. \n\n Este curso ha detectado un error. NO se grabara su progreso. Por favor, cierre y reincie el curso.",SubscriptionInactive:"Sorry this subscription is no longer active. Please contact support at https://safetyskills.com/support"},m={disableNext:!1,frameNumber:n,kickback:n,on:{animate:n,mute:n,nextEnable:n,nextDisable:n,pause:n,play:n,previousEnable:n,previousDisable:n,progressBar:n,slidePlay:n,slidePause:n,slideMute:n,slideUnMute:n,scoFinish:n,unMute:n},presentor:n,title:n},p=!1,f=!1,g=!1,b=!1,h=new Date,_={frames:[],languages:[],path:"sco.xml",quizTotal:0,scaled_passing_score:n,title:"Example Course",XML:n},k={_relayUrl:"https://admin.safetyskills.com/api/aicc-relay/",_version:"4.0",Exit:function(){v(this._relayUrl,"POST",{data:{command:"ExitAU",version:this._version,session_id:a.aicc_sid},done:function(e){T(!1,e.responseText)}})},Put:function(e){var t=e.completion_status,n="";p||("completed"===t||"passed"===t)&&(p=!0,n="&completed=true"),e.exit&&""!==e.exit&&(t=t+","+e.exit),v(this._relayUrl+n,"POST",{data:{command:"PutParam",version:this._version,session_id:a.aicc_sid,aicc_data:"[CORE]\nlesson_location="+e.location+"\nscore="+e.score.raw+"\nlesson_status="+t+"\ntime="+e.session_time+"\n[CORE_LESSON]\r\nsuspend_data="+JSON.stringify(e.suspend_data)},done:function(e){o="0",T(!1,e.responseText)},fail:this.Fail})},Fail:function(e){401===e.statusCode?T(!0,d.SubscriptionInactive):(o="100",r.learner_id="~")}},v=function(t,a,n){var i="",r={done:function(){},fail:function(){}},s="POST"===a&&e.XDomainRequest?new e.XDomainRequest:new XMLHttpRequest;if(n){if(n.cache===!1&&(t=t+"?_="+(new Date).getTime()),n.data){var o=[];for(var c in n.data)n.data.hasOwnProperty(c)&&o.push(encodeURIComponent(c)+"="+encodeURIComponent(n.data[c]));i=o.join("&")}n.done&&(r.done=n.done),n.fail&&(r.fail=n.fail)}s.open(a,t),s.setRequestHeader?(s.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),s.onreadystatechange=function(){4===this.readyState&&(200===this.status?r.done.call(r,this):r.fail.call(r,this))},setTimeout(function(){s.send(i)},0)):(s.onload=function(){r.done.call(r,s)},s.onerror=function(){r.fail.call(r,s)},s.onprogress=function(){},s.ontimeout=function(){},s.onerror=function(){},setTimeout(function(){s.send(i)},0))},y=function(e){var t=f?"slide-kick":"slide-frame";return e.indexOf(".swf")>-1?'<embed fullscreen="yes" height="100%" src="'+e+'" width="100%" id="'+t+'" name="'+t+'" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" quality="high" wmode="opaque"></embed>':'<iframe height="100%" id="'+t+'" scrolling="no" src="'+e+'" style="border: none; overflow: hidden;" width="100%"></iframe>'},S=function(){if("~"!==r.learner_id){switch(r.learner_id="~",s){case"AICC":k.Exit();break;case"SCORM":G.Terminate();break;case"TinCan":}return T(!1,"Course Terminated"),!0}return!1},w=function(e){for(var t=0;t<_.frames.length;t++)if(_.frames[t].getAttribute("file")===e)return t+1},E=function(e){for(var t=0;t<_.frames.length;t++)if(_.frames[t].getAttribute("file")===e)return _.frames[t];return _.frames[0]},A=function(a){if("~"===r.learner_id&&T(!0,d.NotInitialized),e.addEventListener("beforeunload",function(e){if(S()){var t="Data saved, click to continue...";return(e||window.event).returnValue=t,t}}),t.onkeydown=function(e){var t=!1;39===e.which&&(c.nextEnabled||l&&e.shiftKey&&e.ctrlKey)&&(M(),t=!0),37===e.which&&c.previousEnabled&&(I(),t=!0),38===e.which&&(O(),t=!0),l||119===e.which&&(l=!0,t=!0,T(!1,"Debug enabled")),t&&e.preventDefault()},r.location&&""!==r.location)for(var n=r.location.split("/")[0],s=i.GetLanguages(),o=0;o<s.length;o++)s[o].id===n&&(c.language=n);L(c.language),t.title=_.title,a("resume"===r.entry)},T=function(e,t){e?l?console.log(t):alert(t):console&&console.log&&console.log(t)},x=function(e,t){var a=new Date;a.setTime(e);var n="",i="000"+Math.floor(e/36e5),r="0"+a.getMinutes(),s="0"+a.getSeconds(),o="0"+Math.round(a.getMilliseconds()/10);if(n=i.substr(i.length-4)+":"+r.substr(r.length-2)+":",n+=s.substr(s.length-2)+"."+o.substr(o.length-2),"2004"===t){var c=n.split(":"),l=c[0],u=c[1],d=c[2];n="PT"+l+"H"+u+"M"+d+"S"}return n},C=function(){g?(m.on.unMute&&m.on.unMute(),g=!1,m.on.slideUnMute&&m.on.slideUnMute()):(m.on.mute&&m.on.mute(),g=!0,m.on.slideMute&&m.on.slideMute())},M=function(){if(u&&u<w(c.frame.getAttribute("file")))alert(d.DemoExceeded);else{for(var e,t=!1,a=f?c.frame.getElementsByTagName("kickback"):_.frames,i=f?c.kickback.getAttribute("file"):c.frame.getAttribute("file"),r=0;r<a.length;r++){var s=a[r].getAttribute("file");if(t){e=s;break}i===s&&(t=!0)}if(t&&e){var o=E(e);z(o)&&(f?c.kickback=o:c.frame=o)}else f&&(f=!1,c.kickback=n,z(c.frame,!0))}},L=function(e){for(var t,a=_.XML.getElementsByTagName("topics"),n=0;n<a.length;n++){var i=a[n];i.getAttribute("lang")===e&&(t=i,_.title=t.getAttribute("title"))}_.frames=t.getElementsByTagName("page"),_.quizTotal=0;for(var r=0;r<_.frames.length;r++){var s=_.frames[r];"quiz"===s.getAttribute("pType")&&_.quizTotal++}},N=function(e){var t={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([\w\.\-\_]+)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},a={},n=e.substring(e.indexOf("[")).split(/\n|\r\n/g),i=null;return n.forEach(function(e){if(!t.comment.test(e))if(t.param.test(e)){var n=e.match(t.param);i?a[i.toLowerCase()][n[1].toLowerCase()]=n[2]:a[n[1].toLowerCase()]=n[2]}else if(t.section.test(e)){var r=e.match(t.section);a[r[1].toLowerCase()]={},i=r[1].toLowerCase()}else 0===e.length&&i&&(i=null)}),a},P=function(){b?(m.on.play&&m.on.play(),b=!1,m.on.slidePlay&&m.on.slidePlay()):(m.on.pause&&m.on.pause(),b=!0,m.on.slidePause&&m.on.slidePause())},I=function(){var e,t=f?c.frame.getElementsByTagName("kickback"):_.frames,a=f?c.kickback.getAttribute("file"):c.frame.getAttribute("file");if(t[0].getAttribute("file")!==a){for(var n=0;n<t.length;n++){var i=t[n].getAttribute("file");if(e&&a===i)break;e=i}var r=E(e);z(r)&&(f?c.kickback=r:c.frame=r)}},O=function(){f?(m.kickback.empty(),m.kickback.append(y(c.kickback.getAttribute("file")))):(m.presentor.empty(),m.presentor.append(y(c.frame.getAttribute("file")))),m.on.play&&(m.on.play(),b=!1)},G={_api:n,Commit:function(){var e=this.getApi(),t="false";return e&&(t="2004"===s?e.Commit(""):e.LMSCommit("")),t.toString()},getApi:function(){if(!this._api){var t="API";"2004"===s&&(t="API_1484_11");try{null!==e.parent&&e.parent!==e&&(this._api=this.scanParents(e.parent,t)),this._api===n&&null!==e.top.opener&&(this._api=this.scanParents(e.top.opener,t))}catch(a){}}return this._api},GetErrorString:function(e){var t=this.getApi(),a="";return t&&(a="2004"===s?t.GetErrorString(e):t.LMSGetErrorString(e)),a.toString()},GetLastError:function(){var e=this.getApi(),t=100;return e&&(t="2004"===s?e.GetLastError():e.LMSGetLastError()),t.toString()},GetValue:function(e){var t=this.getApi(),a="",n="100";if(t){if("2004"===s){switch(e){case"cmi.core.lesson_status":e="cmi.completion_status";break;case"cmi.core.entry":e="cmi.entry";break;case"cmi.core.session_time":e="cmi.session_time";break;case"cmi.core.total_time":e="cmi.total_time";break;case"cmi.core.lesson_location":e="cmi.location";break;case"cmi.core.student_name":e="cmi.learner_name";break;case"cmi.core.student_id":e="cmi.learner_id";break;case"cmi.student_preference._children":e="cmi.learner_preference._children";break;case"cmi.student_preference.language":e="cmi.learner_preference.language";break;case"cmi.core.score._children":e="cmi.score._children";break;case"cmi.core.score.raw":e="cmi.score.raw";break;case"cmi.core.score.min":e="cmi.score.min";break;case"cmi.core.score.max":e="cmi.score.max"}a=t.GetValue(e),n=t.GetLastError().toString()}else a=t.LMSGetValue(e),n=t.LMSGetLastError().toString();"0"!==n&&(a="")}return a.toString()},Initialize:function(){var e=this.getApi(),t="false";return e&&(t="2004"===s?e.Initialize(""):e.LMSInitialize("")),t.toString()},scanParents:function(e,t){for(var a=0;null===e[t]&&null!==e.parent&&e.parent!==e;){if(a++,a>50)return n;e=e.parent}return e[t]},SetValue:function(e,t){var a=this.getApi();if(a)if("2004"===s){switch(e){case"cmi.core.lesson_status":("passed"===t||"failed"===t)&&(e="cmi.success_status"),("completed"===t||"incomplete"===t)&&(e="cmi.completion_status");break;case"cmi.core.session_time":e="cmi.session_time";break;case"cmi.core.lesson_location":e="cmi.location";break;case"cmi.core.exit":e="cmi.exit";break;case"cmi.core.score.raw":e="cmi.score.raw",a.SetValue("cmi.score.scaled",t/100)}a.SetValue(e,t)}else"cmi.suspend_data"===e&&(t=JSON.stringify(t)),a.LMSSetValue(e,t)},Terminate:function(){var e=this.getApi(),t="false";return e&&(t="2004"===s?e.Terminate(""):e.LMSFinish("")),t.toString()}},z=function(t,a){var n=t.getAttribute("file"),u=w(n),p="true"===t.getAttribute("end"),g="survey"===t.getAttribute("pType"),v="quiz"===t.getAttribute("pType")||"summary"===t.getAttribute("pType"),E=t.getElementsByTagName("narration")[0],A=t.getElementsByTagName("bullets")[0];if("~"!==r.learner_id){var C=new Date,M=C.getTime()-h.getTime(),L=x(M,s);switch(f||(r.location=n),r.session_time=L.toString(),(p||g)&&(r.exit="",r.completion_status=_.scaled_passing_score?"passed":"completed"),s){case"AICC":k.Put(r);break;case"SCORM":f||(G.SetValue("cmi.core.lesson_location",r.location),o=G.GetLastError()),"0"===o&&(G.SetValue("cmi.core.session_time",r.session_time),G.SetValue("cmi.core.exit",r.exit),G.SetValue("cmi.core.lesson_status",r.completion_status),G.SetValue("cmi.core.score.raw",r.score.raw),G.SetValue("cmi.suspend_data",r.suspend_data),o=G.GetLastError()),"0"===o&&(G.Commit(),o=G.GetLastError());break;case"TinCan":}}else T(!0,d.NotInitialized);if("0"===o||l){if(m.frameNumber&&m.frameNumber.html(u+" / "+_.frames.length),m.on.progressBar){var N=u/_.frames.length;isNaN(N)&&(N=0),N>1&&(N=1),m.on.progressBar(100*N)}return c.captions=E&&null!==E?e.XDomainRequest?E.xml:(new XMLSerializer).serializeToString(E):"",c.bullets=A&&null!==A?e.XDomainRequest?A.xml:(new XMLSerializer).serializeToString(A):"",a?(m.kickback.empty(),m.kickback.hide(),m.presentor.show(),c.nextEnabled=!1,c.previousEnabled=!0):(f?m.kickback&&(m.kickback.show(),m.presentor.hide(),m.kickback.empty(),m.kickback.append(y(n))):m.presentor&&(m.kickback.hide(),m.presentor.show(),m.presentor.empty(),m.presentor.append(y(n))),c.previousEnabled=f?c.frame.getElementsByTagName("kickback")[0].getAttribute("file")!==n:_.frames[0].getAttribute("file")!==n,c.nextEnabled=!f&&(v||m.disableNext&&u>1&&!g)?!1:!0),c.previousEnabled?m.on.previousEnable():m.on.previousDisable(),c.nextEnabled?m.on.nextEnable():m.on.nextDisable(),(v||g||p)&&i.SlideStart({}),m.on.play&&(m.on.play(),b=!1),p&&(S(),m.on.scoFinish()),!0}return T(!0,G.GetErrorString(o)+d.CommunicationIssue),!1};return i.InitSco=function(n){var i=t.createElement("audio");i.id="end",i.src="end-sound.mp3",i.preload="auto",t.body.appendChild(i);try{var o=new Audio;o.autoplay=!0,o.volume=0,o.addEventListener("play",function(){e.CanAutoplay=!0},!1),o.src="blank.mp3"}catch(m){}var f=t.createElement("audio");f.id="blank",f.src="blank.mp3",f.preload="auto",t.body.appendChild(f),a.debug&&(l=!0,T(!1,"Debug Enabled")),a.demo?(u=a.demo,T(!1,"Demo selected")):a.aicc_url&&a.subid?(s="AICC",k._relayUrl+=a.subid+"?relay-url="+a.aicc_url,T(!1,"AICC selected")):(s="SCORM",T(!1,"SCORM selected"));var g=t.querySelector("meta[name=author]"),b=Math.floor(h.getTime()/864e5-h.getTimezoneOffset()/1440+2440587.5);g&&g.getAttribute("content")<b?T(!0,d.SubscriptionInactive):(a.sco&&(_.path=a.sco),v(_.path,"GET",{cache:!1,done:function(e){_.XML=e.responseXML,_.languages=_.XML.getElementsByTagName("language"),c.language=_.XML.getElementsByTagName("languages")[0].getAttribute("default");var t=_.XML.getElementsByTagName("sco")[0];switch(t.getAttribute("mastery-score")&&(_.scaled_passing_score=t.getAttribute("mastery-score")),s){case"AICC":v(k._relayUrl,"POST",{data:{command:"GetParam",version:k._version,session_id:a.aicc_sid},done:function(e){T(!1,e.responseText);var t=N(e.responseText),a=t.core.lesson_status.toLowerCase();if("n;i".split(";").indexOf(a.slice(0,1))>-1?r.completion_status="incomplete":(r.completion_status=a,p=!0),a.indexOf(",")>-1){var i=a.split(",")[1];"r"===i.slice(0,1)&&(r.entry="resume"),"a"===i.slice(0,1)&&(r.entry="ab-initio")}r.learner_id=t.core.student_id,r.learner_name=t.core.student_name,r.location=t.core.lesson_location;var s=t.core.score.split(",");r.score.raw=s[0],t.core_lesson&&t.core_lesson.suspend_data&&(r.suspend_data=JSON.parse(t.core_lesson.suspend_data)),A(n),k.Put(r)},fail:function(e){401===e.statusCode&&T(!0,d.SubscriptionInactive),A(n)}});break;case"SCORM":"true"===G.Initialize()&&("not attempted"===G.GetValue("cmi.core.lesson_status")&&G.SetValue("cmi.core.lesson_status","incomplete"),r.learner_id=G.GetValue("cmi.core.student_id"),r.learner_name=G.GetValue("cmi.core.student_name"),r.entry=G.GetValue("cmi.core.entry"),r.location=G.GetValue("cmi.core.lesson_location"),r.score.raw=G.GetValue("cmi.core.score.raw"),""!==G.GetValue("cmi.suspend_data")&&(r.suspend_data=JSON.parse(G.GetValue("cmi.suspend_data")))),A(n);break;case"TinCan":break;default:A(n)}}}))},i.GetLanguages=function(){for(var e=[],t=0;t<_.languages.length;t++){var a=_.languages[t];e[t]={id:a.getAttribute("id"),label:a.getAttribute("label")}}return e},i.SelectLanguage=function(e){t.getElementById("blank").play(),c.language=e?e:_.XML.getElementsByTagName("languages")[0].getAttribute("default"),L(c.language),c.frame=_.frames[0]},i.Resume=function(){if(t.getElementById("blank").play(),r.location&&""!==r.location)for(var e=r.location.split("/")[0],a=i.GetLanguages(),n=0;n<a.length;n++)a[n].id===e&&(c.language=e);L(c.language);var s=E(r.location);s&&(c.frame=s)},i.GetLocalizedValues=function(){for(var e={},t=0;t<_.languages.length;t++){var a=_.languages[t];if(a.getAttribute("id")===c.language)for(var n=a.childNodes,i=0;i<n.length;i++)e[n[i].tagName]=n[i].textContent?n[i].textContent:n[i].firstChild.nodeValue}return e},i.InitInterface=function(e){t.getElementById("blank").play(),m.on.animate=e.onAnimate,m.on.progressBar=e.setProgressBar,m.on.scoFinish=e.onScoFinish,m.title=e.titleField,m.frameNumber=e.frameField,m.presentor=e.presentorFrame,m.kickback=e.kickbackFrame,m.presentor.show(),m.kickback.hide(),m.title&&(m.title.html(_.title),t.title=_.title),z(c.frame)},i.Mute=function(e){return m.on.mute=e.mute,m.on.unMute=e.unMute,m.on.unMute(),C},i.Next=function(e){return m.on.nextDisable=e.onDisable,m.on.nextEnable=e.onEnable,e.disableOnNext&&(m.disableNext=e.disableOnNext),M},i.Play=function(e){return m.on.play=e.play,m.on.pause=e.pause,P},i.Previous=function(e){return m.on.previousDisable=e.onDisable,m.on.previousEnable=e.onEnable,I},i.Replay=function(){return O},i.EndSco=function(){return function(){S(),e.top.opener?e.top.close():T(!0,"Data saved, but window was not able to be closed")}},i.GetStudentName=function(){return r.learner_name},i.SubmitSurvey=function(e){if(e){var a={Comments:e.Comments,CourseName:t.title,Emphasis:e.Emphasis,Intro:e.Intro,Overall:e.Overall,ScreenHeight:screen.height,ScreenWidth:screen.width,Student:"",Summaries:e.Summaries,Thoroughness:e.Thoroughness,Url:location.href,UserAgent:navigator.userAgent};a.Student=e.IsAnonymous?"anonymous":r.learner_name,v("https://admin.safetyskills.com/api/survey","POST",{data:a,done:function(){T(!1,"Survey Data: "+a)}})}M()},i.SlideStart=function(e){m.on.slidePause=e.slidePause,m.on.slidePlay=e.slidePlay,m.on.slideMute=e.slideMute,m.on.slideUnMute=e.slideUnMute,m.on.animate&&m.on.animate(c.bullets,c.captions),g&&m.on.slideMute&&m.on.slideMute()},i.SlideEnd=function(){setTimeout(function(){t.getElementById("end").play(),e.CanAutoplay?(m.on.nextEnable(),c.nextEnabled=!0):M()},1e3)},i.ScoreResults=function(){var e=0;r.suspend_data.answered&&(e=r.suspend_data.answered.length);var t=e/_.quizTotal;return{answered:e,passed:t>=_.scaled_passing_score,percent:(100*t).toFixed(2),total:_.quizTotal}},i.QuizCorrect=function(){if(_.scaled_passing_score&&"quiz"===c.frame.getAttribute("pType")){var e=-1;if(r.suspend_data.answered?e=r.suspend_data.answered.indexOf(c.frame.getAttribute("file")):r.suspend_data.answered=[],-1===e){r.suspend_data.answered.push(c.frame.getAttribute("file"));var t=0;r.suspend_data.answered&&(t=r.suspend_data.answered.length);var a=t/_.quizTotal;r.score.raw=(100*a).toFixed(2)}}M()},i.QuizIncorrect=function(){var e=c.frame.getElementsByTagName("kickback")[0];if(_.scaled_passing_score){var t=-1;if(r.suspend_data.answered&&(t=r.suspend_data.answered.indexOf(c.frame.getAttribute("file"))),t>-1){r.suspend_data.answered.splice(t,1);var a=0;r.suspend_data.answered&&(a=r.suspend_data.answered.length);var n=a/_.quizTotal;r.score.raw=(100*n).toFixed(2)}if(e){var i=E(e.getAttribute("file"));f=!1,z(i)&&(c.frame=i)}else M()}else if(e){var s=E(e.getAttribute("file"));f=!0,z(s)&&(c.kickback=s)}},T(!1,"SS v2.8: Loaded"),i}(this,this.document,this.querystrings||{});
//# sourceMappingURL=ss.2.8.js.map